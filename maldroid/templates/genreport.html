{% extends "layout.html" %}
{% block body %}

<nav id="maldroidNavbar" class="navbar navbar-default navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbarCollapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="{{ url_for('home') }}">malDroid</a>
        </div>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="nav navbar-nav">
                <li><a href="{{ url_for('about') }}">About</a></li>
                <li><a href="https://github.com/Poppyseedplehzr/maldroid" target="_blank">Source</a></li>
                <li><a href="{{ url_for('contact') }}">Contact</a></li>
                <li class="active"><a href="{{ url_for('reports') }}">Reports</a></li>

            </ul>
        </div>
    </div>
</nav>

<div class="container">
    <div class="jumbotron">
      {% if not report %}
        <h2> Report for {{comname}} is not yet ready.  Please try again shortly.</h2>
      {% else %}
        <h2>Report for {{comname}}</h2>
        <p>SHA256: {{digest}}
          <br>App submitted for analysis on: {{tstamp}} UTC
          <br>
              <h3>Androguard Analysis</h3><br>
              {% for r in report.keys() %}
                {% if r == "androguard_perms" %}
                  <h4>Requested Android Permissions:</h4><br>
                  {% for k in report[r].keys() %}
                    {{k.split(".")[-1]}} - {{report[r][k][-1]}}<br>
                  {% endfor %}
                  <br><br>
                {% elif r == "androguard_risk" %}
                  <h4>Androguard Risk Assessment:</h4><br>
                  {% for k in report[r].keys() %}
                    {% if k == "RedFlags" %}
                        {% for flag in report[r][k].keys() %}
                          {{flag}}:
                            {% for val in report[r][k][flag].keys() %}
                              {{val}} - {{report[r][k][flag][val]}},
                            {% endfor %}<br>
                        {% endfor %}
                    {% elif k == "FuzzyRisk"%}
                      Fuzzy Risk - {{report[r][k]["VALUE"]}}
                    {% endif %}
                  {% endfor %}
                  <br><br>
                {% endif %}
              {% endfor %}
        </p>
      {% endif %}

    </div>
</div>
{% endblock %}
